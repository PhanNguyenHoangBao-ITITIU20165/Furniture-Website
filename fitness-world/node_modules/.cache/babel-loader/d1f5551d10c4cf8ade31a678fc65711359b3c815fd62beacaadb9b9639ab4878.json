{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport { getUserInfo, updateUserInfo, userSignIn, userSignUp } from './authApi';\nimport Cookies from 'js-cookie';\n\n// const accessToken = Cookies.get('accessToken') ?? null;\n// console.log(accessToken);\n\nconst initialState = {\n  userData: null,\n  accessToken: null,\n  loading: false,\n  error: null,\n  role: 'unknown'\n};\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    signOut: state => {\n      Cookies.remove('accessToken');\n      state.loading = false;\n      state.error = null;\n      state.userData = null;\n      state.accessToken = null;\n      state.role = 'unknown';\n    },\n    setCredentials: (state, {\n      payload\n    }) => {\n      state.userData = payload;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Sign In\n    .addCase(userSignIn.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(userSignIn.fulfilled, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.userData = payload.validUser;\n      state.role = payload.role;\n      state.accessToken = payload.accessToken;\n    }).addCase(userSignIn.rejected, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.error = payload ? payload : null;\n    })\n    // Sign Up\n    .addCase(userSignUp.pending, state => {\n      state.loading = true;\n    }).addCase(userSignUp.fulfilled, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.userData = payload.newUser;\n      state.role = payload.role;\n      state.accessToken = payload.accessToken;\n      state.error = null;\n    }).addCase(userSignUp.rejected, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.error = payload ? payload : null;\n    })\n    // get user info after reloading\n    .addCase(getUserInfo.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(getUserInfo.fulfilled, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.userData = payload;\n      state.role = payload.role;\n      // state.accessToken = payload.cookie;\n    }).addCase(getUserInfo.rejected, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.error = payload ? payload : null;\n    })\n    //update user info\n    .addCase(updateUserInfo.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(updateUserInfo.fulfilled, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      // state.userData = payload;\n    }).addCase(updateUserInfo.rejected, (state, {\n      payload\n    }) => {\n      state.loading = false;\n      state.error = payload ? payload : null;\n    });\n    // Forgot password\n  }\n});\nexport const {\n  signOut,\n  setCredentials\n} = authSlice.actions;\nexport default authSlice;\n\n// export const currentToken = (state: IRootState) => state.authaccessToken.","map":{"version":3,"names":["createSlice","getUserInfo","updateUserInfo","userSignIn","userSignUp","Cookies","initialState","userData","accessToken","loading","error","role","authSlice","name","reducers","signOut","state","remove","setCredentials","payload","extraReducers","builder","addCase","pending","fulfilled","validUser","rejected","newUser","actions"],"sources":["D:/FurniScape/furniture-world/src/redux/api/authSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice, isRejectedWithValue } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { IRootState } from '../store';\r\nimport { UserForgotPassword, getUserInfo, updateUserInfo, userSignIn, userSignOut, userSignUp } from './authApi';\r\nimport Cookies from 'js-cookie';\r\n\r\n// const accessToken = Cookies.get('accessToken') ?? null;\r\n// console.log(accessToken);\r\nexport interface IUserData {\r\n    id: string;\r\n    fullname: string;\r\n    phone: string;\r\n    address: string;\r\n    email: string;\r\n    country: string;\r\n    password: string;\r\n}\r\n\r\ninterface IUserState {\r\n    userData: any | undefined;\r\n    accessToken: string | null;\r\n    loading: boolean;\r\n    error: Object | null;\r\n    role: string;\r\n}\r\n\r\nconst initialState: IUserState = {\r\n    userData: null,\r\n    accessToken: null,\r\n    loading: false,\r\n    error: null,\r\n    role: 'unknown',\r\n};\r\n\r\nconst authSlice = createSlice({\r\n    name: 'auth',\r\n    initialState,\r\n    reducers: {\r\n        signOut: (state) => {\r\n            Cookies.remove('accessToken');\r\n            state.loading = false;\r\n            state.error = null;\r\n            state.userData = null;\r\n            state.accessToken = null;\r\n            state.role = 'unknown';\r\n        },\r\n        setCredentials: (state, { payload }) => {\r\n            state.userData = payload;\r\n        },\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder\r\n            // Sign In\r\n            .addCase(userSignIn.pending, (state) => {\r\n                state.loading = true;\r\n                state.error = null;\r\n            })\r\n            .addCase(userSignIn.fulfilled, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.userData = payload.validUser;\r\n                state.role = payload.role;\r\n                state.accessToken = payload.accessToken;\r\n            })\r\n            .addCase(userSignIn.rejected, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.error = payload ? payload : null;\r\n            })\r\n            // Sign Up\r\n            .addCase(userSignUp.pending, (state) => {\r\n                state.loading = true;\r\n            })\r\n            .addCase(userSignUp.fulfilled, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.userData = payload.newUser;\r\n                state.role = payload.role;\r\n                state.accessToken = payload.accessToken;\r\n                state.error = null;\r\n            })\r\n            .addCase(userSignUp.rejected, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.error = payload ? payload : null;\r\n            })\r\n            // get user info after reloading\r\n            .addCase(getUserInfo.pending, (state) => {\r\n                state.loading = true;\r\n                state.error = null;\r\n            })\r\n            .addCase(getUserInfo.fulfilled, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.userData = payload;\r\n                state.role = payload.role;\r\n                // state.accessToken = payload.cookie;\r\n            })\r\n            .addCase(getUserInfo.rejected, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.error = payload ? payload : null;\r\n            })\r\n            //update user info\r\n            .addCase(updateUserInfo.pending, (state) => {\r\n                state.loading = true;\r\n                state.error = null;\r\n            })\r\n            .addCase(updateUserInfo.fulfilled, (state, { payload }) => {\r\n                state.loading = false;\r\n                // state.userData = payload;\r\n            })\r\n            .addCase(updateUserInfo.rejected, (state, { payload }) => {\r\n                state.loading = false;\r\n                state.error = payload ? payload : null;\r\n            });\r\n        // Forgot password\r\n    },\r\n});\r\n\r\nexport const { signOut, setCredentials } = authSlice.actions;\r\nexport default authSlice;\r\n\r\n// export const currentToken = (state: IRootState) => state.authaccessToken.\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}